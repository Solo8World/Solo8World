---
title: PG窗口函数的应用实践
date: 2022-04-29 19:25:48
tags:
- postgres
categories:
- [技术]
description: 常用的sql语句往往只支持单一的数据范围统计，而窗口函数支持更加灵活更加多样的数据范围划定
---
### 概念
窗口函数主要用于聚合计算，相当于我们的分组语句group by。
常用的sql语句往往只支持单一的数据范围统计，而窗口函数支持更加灵活更加多样的数据范围划定。
本质上，是否需要使用窗口函数，取决于你的需求场景是否涉及到同一种事物的不同数据范围的同时计算。


### 1.排名类
排名，普通的只涉及到单一数据范围的排名的话，我们只需要正常的排序就可以满足，
当你需要同时计算每个单位在不同数据范围下的排名计算，就需要使用窗口函数，
比如各个店铺销售额在楼层中的排名、在所属业态中的排名、在整个商场中的排名。




### 2.聚合类
聚合类，或者说累加，包括sum、avg、max、count等聚合函数。
同样的，如果我们只涉及到一种数据范围的聚合计算，那么只需要正常的聚合语句就可以完成。
当你需要同时计算某个值在不同数据范围下的聚合计算，就需要使用窗口函数，
比如同时计算某商场每日新增的会员数量，以及截止到当日累计的会员数量。


### 3.其他运用
移动计算类

